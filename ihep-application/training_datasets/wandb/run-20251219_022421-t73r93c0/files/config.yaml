_wandb:
    value:
        cli_version: 0.23.1
        e:
            stamh0acua0y4n98dzteiy9pkac5488a:
                args:
                    - --config
                    - configs/medgemma_finetune.yaml
                    - --max_steps
                    - "10"
                codePath: training_datasets/train_medgemma.py
                codePathLocal: train_medgemma.py
                email: jaymagik095@gmail.com
                executable: /Users/nexus1/Documents/ihep-app/.venv/bin/python
                git:
                    commit: 306d3a57aae240614dd242fc7454d8e68a307701
                    remote: https://github.com/omniunumco/ihep.git
                host: nexus-dev.local
                os: macOS-26.2-arm64-arm-64bit-Mach-O
                program: /Users/nexus1/Documents/ihep-app/ihep/training_datasets/train_medgemma.py
                python: CPython 3.14.2
                root: /Users/nexus1/Documents/ihep-app/ihep/training_datasets
                startedAt: "2025-12-19T07:24:21.196098Z"
                writerId: stamh0acua0y4n98dzteiy9pkac5488a
        m: []
        python_version: 3.14.2
        t:
            "1":
                - 1
                - 11
                - 49
                - 51
                - 71
                - 98
            "2":
                - 1
                - 11
                - 49
                - 51
                - 71
                - 98
            "3":
                - 13
                - 15
            "4": 3.14.2
            "5": 0.23.1
            "6": 4.57.3
            "12": 0.23.1
            "13": darwin-arm64
compute:
    value:
        deepspeed:
            config: ~/Documents/DeepSpeed/tests/model/Megatron_GPT2/ds_config_func_bs8_zero2.json
            enabled: false
        devices: auto
        enable_flash_attention: true
        enable_gradient_checkpointing: true
        strategy: ddp
datasets:
    value:
        processing:
            max_samples: null
            padding: max_length
            seed: 42
            shuffle: true
            truncation: true
        test:
            - path: evaluation/raw/held_out_test.jsonl
        train:
            - path: clinical/raw/hiv_care_continuum.jsonl
              task: clinical_decision_support
              weight: 1.5
            - path: clinical/raw/chronic_disease_management.jsonl
              task: clinical_decision_support
              weight: 1.2
            - path: adherence/raw/medication_adherence_patterns.jsonl
              task: adherence_coaching
              weight: 1.3
            - path: mental_health/raw/mental_health_assessments.jsonl
              task: mental_health_support
              weight: 1.4
            - path: social_determinants/raw/sdoh_interventions.jsonl
              task: sdoh_navigation
              weight: 1
            - path: risk_prediction/raw/risk_stratification_training.jsonl
              task: risk_assessment
              weight: 1.2
            - path: conversational/raw/patient_dialogues.jsonl
              task: conversational_support
              weight: 1.1
        validation:
            - path: evaluation/raw/clinical_eval.jsonl
            - path: evaluation/raw/safety_eval.jsonl
evaluation:
    value:
        bias_eval:
            enabled: true
            metrics:
                - demographic_parity
                - equalized_odds
                - calibration_by_group
            protected_attributes:
                - gender
                - age_group
                - race_ethnicity
        clinical_eval:
            enabled: true
            metrics:
                - guideline_adherence
                - recommendation_accuracy
                - safety_compliance
        metrics:
            - perplexity
            - accuracy
            - f1_score
            - bleu
            - rouge
            - bertscore
        safety_eval:
            enabled: true
            metrics:
                - crisis_detection_rate
                - phi_leak_rate
                - harmful_content_rate
                - appropriate_escalation_rate
lora:
    value:
        alpha: 128
        bias: none
        dropout: 0.05
        enabled: true
        r: 64
        target_modules:
            - q_proj
            - k_proj
            - v_proj
            - o_proj
            - gate_proj
            - up_proj
            - down_proj
        task_type: CAUSAL_LM
model:
    value:
        base_model: google/medgemma-7b
        gradient_checkpointing: true
        max_length: 4096
        model_type: causal_lm
        precision: bf16
        use_flash_attention: true
output:
    value:
        export:
            ggml: false
            onnx: false
            pytorch: true
            tensorrt: false
        hub_model_id: null
        model_name: medgemma-ihep-digital-twins
        output_dir: ./outputs/medgemma_ihep_finetune
        push_to_hub: false
prompts:
    value:
        adherence_coaching:
            system: |
                You are an AI health coach specialized in medication adherence support.
                Use motivational interviewing techniques and empathetic communication.
                Address barriers without judgment and provide practical solutions.
                Recognize when to escalate to human healthcare providers.
        clinical_decision_support:
            system: |
                You are a clinical decision support AI for HIV care and chronic disease management.
                You provide evidence-based guidance following established treatment guidelines.
                Always recommend consulting with healthcare providers for clinical decisions.
                Be thorough, accurate, and cite evidence levels when possible.
        conversational_support:
            system: |
                You are a compassionate AI health assistant for the IHEP platform.
                Provide personalized health guidance, medication reminders, and emotional support.
                Maintain HIPAA compliance and recognize when to escalate to human providers.
                Speak in a warm, professional tone appropriate for healthcare settings.
        format:
            input_template: |
                User Query: {input}
            instruction_template: |
                {system}

                {instruction}
            output_template: |
                {output}
        mental_health_support:
            system: |
                You are a compassionate AI mental health support assistant.
                Provide trauma-informed, evidence-based emotional support.
                Always assess for crisis situations and provide appropriate resources.
                Never diagnose but help identify concerns and connect to professional help.
                If someone expresses suicidal ideation, immediately provide crisis resources.
        risk_assessment:
            system: |
                You are an AI clinical decision support system for risk stratification.
                Analyze patient data to identify risk levels for care disengagement and adverse outcomes.
                Provide actionable, explainable recommendations to clinical teams.
                Use SHAP-like explanations for model interpretability.
        sdoh_navigation:
            system: |
                You are an AI care navigator for social determinants of health.
                Help connect patients with resources for housing, food, transportation, and employment.
                Maintain a compassionate, non-judgmental approach.
                Know local and national resource programs and eligibility requirements.
reproducibility:
    value:
        cudnn_benchmark: false
        deterministic: true
        seed: 42
safety:
    value:
        crisis_detection:
            enabled: true
            keywords:
                - suicide
                - kill myself
                - end my life
                - want to die
                - hurt myself
            response: |
                I'm concerned about what you've shared. If you're having thoughts of suicide or self-harm,
                please reach out for immediate support:
                - 988 Suicide & Crisis Lifeline: Call or text 988
                - Crisis Text Line: Text HOME to 741741
                - Emergency: Call 911 or go to your nearest emergency room
        filter_harmful_content: true
        filter_phi: true
        max_output_tokens: 2048
        medical_disclaimer:
            enabled: true
            text: This information is for educational purposes. Please consult your healthcare provider for medical advice.
        repetition_penalty: 1.1
        temperature: 0.7
        top_k: 50
        top_p: 0.95
training:
    value:
        adam_beta1: 0.9
        adam_beta2: 0.999
        adam_epsilon: 1e-08
        bf16: true
        dataloader_num_workers: 4
        dataloader_pin_memory: true
        ddp_find_unused_parameters: false
        dropout: 0.1
        effective_batch_size: 16
        eval_accumulation_steps: 4
        eval_steps: 250
        eval_strategy: steps
        fp16: false
        gradient_accumulation_steps: 8
        label_smoothing: 0
        learning_rate: 2e-05
        load_best_model_at_end: true
        logging_steps: 50
        logging_strategy: steps
        lr_scheduler_type: cosine
        max_grad_norm: 1
        max_steps: 10
        num_train_epochs: 3
        optim: adamw_torch
        per_device_eval_batch_size: 4
        per_device_train_batch_size: 2
        report_to:
            - tensorboard
            - wandb
        save_steps: 500
        save_strategy: steps
        save_total_limit: 3
        warmup_ratio: 0.03
        weight_decay: 0.01
wandb:
    value:
        enabled: true
        entity: null
        name: medgemma-digital-twins-v1
        project: ihep-medgemma-finetune
        tags:
            - medical
            - hiv
            - digital-twins
            - ihep
